---
import '../styles/global.css';
import type { SanityDocument } from "@sanity/client";
import PageBuilder from "../components/PageBuilder.astro";
import {loadQuery} from '../util/load-query'
import Layout from '../layouts/Layout.astro';

export const prerender = false;

const PAGE_QUERY = `*[_type == "page" && slug.current == $slug][0]{
  ...,
  content[]{
    ...,
  },
}`;

const slug = Astro.params.slug as string;

const { data: page } = await loadQuery<SanityDocument>({
  query: PAGE_QUERY,
  params: { slug },
});
---
<Layout>
  {page?.content && <PageBuilder content={page.content} documentId={page._id} documentType={page._type} />}
</Layout>
