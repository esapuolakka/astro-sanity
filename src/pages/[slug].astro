---
import '../styles/global.css';
import type { SanityDocument } from "@sanity/client";
import PageBuilder from "../components/blocks/PageBuilder.astro";
import {loadQuery} from '../util/load-query'
import Layout from '../layouts/Layout.astro';

const enabled = Astro.url.searchParams.has('preview');

export const prerender = false;

const PAGE_QUERY = `*[_type == "page" && slug.current == $slug][0]{
  ...,
  content[]{
    ...,
    _type == "faqs" => {
      ...,
      faqs[]->
    }
  }
}`;

const slug = Astro.params.slug as string;

const { data: page } = await loadQuery<SanityDocument>({
  query: PAGE_QUERY,
  params: { slug },
  enabled
});
---
<Layout>
  {page?.content && <PageBuilder content={page.content} />}
</Layout>
